import numpy as np
from torch import softmax as sf
from torch import tensor

out = tensor([[-3.4038e+00,  9.2491e-01, -1.1414e+00, -2.4960e+00, -1.6821e+00,
         -3.0022e+00, -3.4840e+00, -2.0053e-01, -8.6135e-01, -1.7341e-01,
         -1.0921e+00, -1.3730e-01,  6.1438e-01, -4.4682e-02, -1.3171e+00,
          1.1571e+00,  1.3766e+00, -6.2116e-01,  1.2577e+00, -1.5713e-01,
         -8.0662e-01,  1.0786e-01,  1.0704e+00,  1.6537e+00, -9.7522e-01,
         -2.0386e+00, -3.2661e+00, -2.8053e+00, -2.1322e+00, -1.0824e+00,
         -2.0826e+00, -4.7286e-01, -3.1087e+00, -2.0754e+00, -1.4878e+00,
         -2.4395e+00, -8.3781e-01, -1.8090e+00, -2.7062e+00, -1.9663e-01,
          6.4210e-01, -1.3713e+00, -1.5942e+00, -3.2388e-01, -8.1280e-01,
         -8.5033e-01,  1.5057e+00, -1.4313e+00, -2.0138e+00, -2.4528e+00,
         -1.5943e+00, -2.4729e+00, -2.6325e+00, -1.0098e+00, -1.0538e-01,
          2.3521e-01, -1.9443e+00, -2.5045e+00, -3.4565e+00,  2.5929e+00,
          1.5067e+00, -2.1932e+00, -2.1229e+00, -1.2937e+00,  1.3517e+00,
         -3.3136e+00, -1.3035e+00, -1.4808e-01, -2.1930e+00, -1.4387e+00,
          9.6720e-03, -2.9745e-01, -1.0840e+00, -2.2382e-01, -4.3218e-01,
         -9.2920e-01, -5.6614e-01,  5.2263e-01, -5.9239e-01, -9.6735e-03,
         -1.6200e+00, -2.8249e+00, -1.1501e+00, -1.9061e+00, -2.3785e-01,
         -8.0103e-01, -2.4642e+00,  7.5612e-01,  8.5335e-01,  6.0842e-01,
          1.4145e+00,  7.1103e-02,  4.7448e-01,  2.5227e+00,  3.0391e+00,
         -9.6457e-01,  1.7123e+00, -3.9031e+00, -3.7946e+00, -1.4047e+00,
         -1.3150e+00, -7.7163e-01, -3.1547e+00,  1.8936e-01, -2.1532e+00,
         -2.7981e+00, -2.1596e+00,  5.6857e-01, -2.7221e+00, -4.7124e+00,
         -3.1094e+00,  1.8315e+00,  9.2343e-02, -1.1246e+00, -2.0386e+00,
         -3.4179e+00, -4.4859e+00, -1.3696e-01, -1.2398e+00, -2.2306e+00,
         -2.3478e+00, -2.8714e+00, -2.7943e+00, -1.3039e+00, -1.5643e+00,
         -2.8045e+00, -2.0342e+00, -1.1071e+00, -2.2086e+00, -1.2809e+00,
         -6.6124e-01, -2.5711e+00, -4.7070e-01, -1.5214e+00, -1.2269e+00,
         -1.2327e+00, -8.1396e-01, -1.6244e+00, -2.2171e+00, -2.4573e+00,
         -2.8737e+00, -2.1287e+00, -3.4099e+00, -3.2556e+00, -1.5496e+00,
         -7.9923e-01, -2.7723e+00, -2.6355e+00, -2.4863e+00, -3.0769e+00,
         -3.1988e+00,  5.0860e-01, -1.7967e+00, -3.0590e-01, -8.0556e-01,
          7.6253e-01, -1.0723e+00, -1.8628e-01, -7.8828e-01, -4.9116e-01,
         -5.4744e-01, -1.7412e-01, -3.1187e-01, -6.5807e-02, -1.0880e+00,
          3.2454e-01, -1.3735e+00, -6.1761e-01, -1.4320e+00,  2.4409e-01,
         -1.1864e+00,  7.0600e-01,  5.9009e-01,  5.6071e-02, -1.1399e+00,
         -1.6330e+00,  4.9902e-01, -1.0720e-01, -1.2559e-02, -2.1820e+00,
         -2.4672e+00, -2.4298e-01, -6.7985e-01,  1.3674e+00,  7.5637e-01,
         -3.4355e-01, -3.4717e-01,  7.6433e-01, -2.0921e+00, -8.2006e-01,
         -8.0720e-01,  4.9576e-01, -1.6972e+00, -2.1067e+00, -2.3958e+00,
          2.5675e-01,  7.5460e-01,  5.1476e-01,  3.3776e-01,  2.1546e-01,
         -2.3891e-01, -2.8047e-03,  1.1426e+00,  5.3897e-01,  1.0142e+00,
         -1.0544e+00, -5.2337e-01, -5.1682e-01, -5.8061e-01, -6.9930e-01,
         -3.4520e+00, -1.0271e+00, -7.3981e-02, -4.1590e-01,  2.1226e-01,
          9.8629e-02, -1.6934e+00, -7.6737e-02, -1.3180e+00,  2.5427e-01,
         -9.2660e-01, -1.2070e+00, -1.1029e+00,  1.9341e-01,  8.8887e-01,
         -1.9487e+00, -1.0890e+00, -2.3628e+00, -2.3272e+00,  1.2439e-01,
         -9.5108e-01, -1.6946e+00,  2.7772e-01, -6.2723e-01, -1.2172e+00,
         -1.6444e+00,  1.8328e-01, -2.5364e-01,  6.6553e-01,  1.1500e+00,
          1.2888e-01, -8.1492e-02,  2.8725e-01, -7.2737e-01, -2.3700e+00,
         -2.0382e+00, -1.8954e+00, -9.1985e-01, -1.4172e+00, -2.1139e+00,
         -1.5027e+00,  5.4534e-01,  1.4073e+00, -2.7190e-01,  3.0258e-01,
         -2.1875e+00, -1.8853e+00, -7.5425e-01, -2.3837e+00, -2.1557e+00,
         -2.7795e+00, -3.2063e+00, -2.2074e-01, -1.1281e+00, -1.8224e+00,
          1.1953e+00,  1.3262e-01,  4.1008e-01, -1.5011e+00, -1.6867e+00,
         -2.7683e+00, -6.9319e-01, -1.3055e+00, -4.3028e-01, -2.6519e+00,
         -9.7250e-01, -1.3629e+00, -1.4003e+00, -2.9381e+00, -3.0167e+00,
         -1.2041e+00, -5.8403e-01, -1.1600e+00, -5.1029e-01,  8.6673e-02,
          6.6253e-01, -7.9402e-01, -2.0468e+00, -1.4376e+00, -2.8755e+00,
         -2.2080e+00, -2.4366e+00, -2.6378e+00, -2.6258e+00, -2.5516e+00,
         -2.4433e+00, -2.2448e+00, -1.0153e+00, -6.9602e-01,  1.6442e-01,
         -2.7777e+00,  7.8082e-01, -1.7140e+00, -3.7913e-01, -1.6762e+00,
         -1.5924e+00, -1.2248e+00, -8.5952e-01,  3.0335e+00,  9.7220e-01,
          1.2272e+00, -4.2307e-01,  1.0086e+00,  1.9566e+00,  2.0069e+00,
          4.8811e+00,  1.6679e+00, -1.4398e-01,  1.5609e+00,  1.5024e+00,
          7.3782e-01, -1.2580e+00, -2.8605e+00,  5.5491e-01,  4.3397e-01,
         -1.3050e+00, -1.2442e+00, -2.1062e+00, -2.0551e+00, -6.6904e+00,
         -1.7914e+00, -2.2500e+00, -2.9350e+00, -1.5867e+00, -3.2035e+00,
         -1.7317e+00, -3.4179e+00, -2.9624e+00, -1.5144e+00, -1.1282e+00,
         -3.3894e-01, -3.5299e+00, -2.5339e+00, -1.4409e+00, -4.9129e+00,
         -1.6679e+00, -3.7817e+00, -1.8657e+00, -2.3412e+00, -2.3336e+00,
         -1.9384e+00, -2.7955e+00, -1.5429e+00, -2.3658e+00, -7.2767e-02,
         -8.0013e-01,  6.4868e-01, -3.0144e+00, -1.6240e+00,  1.8287e-01,
         -1.8331e+00, -6.6145e-01, -1.6763e+00, -1.9146e+00, -2.5029e+00,
         -1.4172e+00, -1.7608e+00, -9.0524e-01, -1.7329e+00, -1.0653e+00,
         -1.4020e+00, -1.1546e+00, -1.3963e+00, -2.4459e+00, -1.0595e+00,
         -1.3019e+00, -3.4915e+00, -5.8170e-01, -1.5173e+00, -1.9261e+00,
         -8.0210e-01, -7.4192e-01, -7.5394e-01, -1.4057e+00, -2.6165e+00,
         -8.7140e-01, -7.2169e-01, -1.8191e+00, -3.2207e+00, -1.0058e+00,
         -1.0864e+00, -3.4637e+00, -2.8500e+00, -2.0690e+00, -3.2016e+00,
         -1.8245e+00, -1.4046e+00, -1.9407e+00,  1.1104e+00,  3.4749e+00,
          2.3701e+00,  2.7730e+00,  4.9392e+00, -2.2830e+00, -1.9689e+00,
         -2.4929e-01,  8.2790e-01, -1.8258e-01, -3.5909e+00,  4.0461e+00,
         -2.3120e+00, -2.5598e+00,  1.4177e+00, -7.2353e-01, -4.5359e-01,
         -1.3197e+00,  1.3723e+00,  2.5615e+00,  4.4428e+00,  2.6106e+00,
          1.4346e+00,  6.9709e+00, -2.0129e+00, -3.6135e-01,  1.4756e+00,
          8.0672e-01,  1.7744e+00,  1.9486e+00, -6.0825e-01, -7.5238e-01,
         -4.4295e-01, -2.5255e+00,  6.1239e-01, -2.9542e-01,  2.0088e-01,
          1.3777e+00, -1.4684e+00,  3.7236e+00,  2.3231e+00,  3.5149e-01,
          2.8488e+00,  4.8254e+00,  3.4018e-01, -2.6376e+00, -1.2088e+00,
         -1.3540e-01,  4.1853e+00,  2.5935e+00,  1.4829e+00, -1.0907e+00,
         -3.5989e+00,  3.3139e-01, -2.5671e+00,  1.7611e+00,  8.0745e-01,
          1.3611e+00,  7.7939e-01,  2.5842e+00, -1.0517e+00,  1.9031e+00,
         -1.6661e+00,  1.0321e+00, -8.4384e-02,  2.5479e+00,  6.1929e-01,
         -1.5733e+00,  9.0787e-01, -2.5231e+00,  2.3052e+00,  1.2605e+00,
          4.8381e+00, -8.9110e-02, -6.9405e-01,  9.9540e-01, -7.5502e-01,
          6.0189e+00,  4.5901e-01, -2.0474e+00,  9.4380e-01,  2.7645e+00,
          9.3500e-01,  1.7498e+00,  7.1574e-01,  2.3869e-01, -3.1612e+00,
          1.4130e+00,  2.3429e+00,  7.2145e-01,  2.7967e+00,  3.2342e+00,
          3.2670e-02, -1.8198e+00,  4.0334e-01, -7.3510e-01,  3.5982e+00,
          9.4413e-02, -1.2698e+00,  3.9381e+00,  3.8802e+00,  9.4497e-01,
         -1.8999e+00,  2.7146e+00, -2.1023e+00,  1.9589e+00,  4.4290e+00,
          4.2126e+00,  4.9339e+00,  2.5846e+00,  3.5043e+00, -1.8348e+00,
         -1.9999e+00, -8.4726e-01,  2.9460e+00,  3.8208e+00, -9.3922e-02,
          1.8217e+00, -3.3375e-01,  2.0926e+00,  1.2945e+00, -1.9119e-01,
         -1.7486e+00,  2.5983e-01, -1.1465e+00,  1.0298e+00, -8.1930e-01,
         -1.7166e+00,  7.2441e-01,  2.2978e+00,  1.8824e+00, -2.2072e+00,
          4.2992e+00,  1.6603e+00, -4.4028e-01, -5.3073e-02,  1.8310e+00,
          1.1148e+00, -1.6117e+00, -2.4901e+00,  2.5255e+00,  6.1657e-01,
         -1.1092e+00,  1.7011e+00,  3.7048e+00,  1.1711e+00, -1.0201e+00,
          3.6908e+00,  1.8983e+00, -1.4374e+00, -1.4178e+00,  1.2663e+00,
          2.3886e+00,  5.9639e-01,  1.9622e+00,  1.1441e+00, -2.6132e+00,
         -9.1361e-01,  3.6423e+00,  2.3356e+00,  6.8639e-01,  3.5946e-01,
         -1.3175e+00, -9.1654e-01,  3.0136e+00,  4.6334e+00,  9.1329e-01,
         -8.0303e-01,  2.9829e+00,  1.8633e-01,  8.7325e-01, -1.9320e+00,
          1.8074e+00,  2.7158e+00,  2.9160e+00, -2.6679e+00,  2.8449e-01,
         -1.8319e+00, -9.2654e-01,  1.7711e+00,  1.9926e+00,  3.5691e+00,
          2.7935e+00,  1.7016e+00, -1.0853e+00,  3.3219e+00,  4.5475e-01,
          2.9734e+00, -3.3268e+00,  2.3700e+00, -8.9441e-01,  2.0902e+00,
         -1.3305e+00, -8.1085e-01,  1.6892e+00,  2.7867e+00,  2.4035e+00,
         -2.4285e+00,  1.4844e+00, -1.5196e+00,  2.0854e+00,  1.1487e+00,
          4.0504e+00, -2.7472e-01,  2.8122e-01, -3.0051e+00,  6.0438e+00,
          1.4120e+00,  1.2754e+00,  3.0957e+00,  1.2256e+00, -5.2473e-01,
          1.9817e+00, -1.2627e+00, -2.3980e+00,  3.0822e+00,  1.3857e+00,
          5.7325e-01,  3.0778e+00,  6.1782e-01,  2.7174e+00,  8.4365e+00,
          1.7194e+00, -1.6371e+00,  2.7607e+00,  2.8107e+00,  4.8289e-01,
         -4.0647e+00,  4.7080e+00, -7.3390e-01, -7.9868e-01,  2.8815e+00,
         -4.1897e-01,  1.5925e-01,  2.3561e+00,  4.0201e+00, -1.5189e+00,
          9.2357e-02, -4.6939e-01,  2.4632e-01,  1.1790e+00, -6.4651e-01,
         -3.1635e+00,  1.2435e-01,  1.4618e+00,  3.1307e+00,  5.3871e+00,
         -6.0967e-02,  1.7705e+00,  8.2480e-01,  1.4438e+00, -2.9028e-01,
          5.1312e+00,  7.8197e-01, -3.5560e-01, -5.1741e-01, -1.1033e+00,
          1.0537e-01, -1.2794e+00,  2.0011e-01, -6.6729e-01, -5.6549e-01,
         -7.1167e-01, -4.9112e-01,  4.7976e-01,  1.0184e+00,  3.3057e+00,
          1.0488e-01,  1.1602e+00,  1.4420e+00, -4.1702e-01,  7.4817e-02,
         -1.2932e-01,  9.5975e-01,  2.3014e+00,  3.0424e+00,  1.3679e+00,
         -3.0845e+00, -1.1627e+00,  2.4903e+00,  6.2287e-01,  3.2764e-01,
          7.7409e-02,  2.1065e+00,  1.9653e+00,  1.3770e+00, -6.9666e-01,
         -8.2930e-02, -5.5139e-01,  1.2242e+00,  1.0043e+00, -1.1061e+00,
         -5.0920e+00,  9.6646e-01, -1.1997e-01, -3.8053e-01, -1.7146e+00,
          2.6070e+00,  3.6552e+00, -1.0300e+00,  1.1317e+00,  1.0578e+00,
          9.5430e-01,  1.2285e-01,  2.5821e-01,  1.6099e+00,  3.0339e+00,
          4.6431e-01, -3.3318e-01,  1.6370e+00,  1.1077e+00, -1.3298e+00,
          1.5452e+00,  5.3405e+00, -1.7189e-01,  1.4122e+00,  3.4850e+00,
         -2.4084e+00,  2.9014e+00, -1.2732e+00,  2.6211e+00,  7.7760e-01,
          1.6869e+00, -1.6080e+00,  1.4871e+00,  2.5263e+00, -1.1378e+00,
          2.4107e+00, -3.4776e+00,  1.6845e+00,  1.6341e+00, -3.0077e-01,
         -1.0963e+00,  2.2864e+00,  1.8674e+00,  3.4870e+00, -7.1666e-01,
         -4.9459e-01,  1.5363e+00,  3.5769e+00, -7.2554e-01, -9.3638e-01,
          1.4831e+00, -8.3853e-01,  7.2208e-02,  4.1730e+00,  1.1729e+00,
          4.0932e+00, -7.8427e-01,  2.7960e+00, -2.4791e+00,  2.9959e+00,
          1.2601e+00, -1.1632e+00,  7.3871e-02,  1.9320e+00,  1.2829e+00,
          9.8732e-01, -5.4660e-01, -2.0069e+00, -1.5428e-01,  3.1872e+00,
          3.5646e+00,  2.3393e+00,  2.2265e+00,  1.5618e+00,  1.5376e+00,
          8.2508e-01, -2.8711e+00,  4.1152e+00, -2.0911e+00,  1.8498e+00,
         -6.9961e-02,  1.8034e+00,  2.6843e+00,  2.4974e+00, -1.7020e-01,
         -9.7208e-01,  4.6472e+00,  2.3874e-01,  5.8428e-01,  2.9287e+00,
          4.0314e-01,  9.2270e-02,  2.5427e+00,  1.4544e+00,  2.6720e+00,
          3.8875e+00,  1.6833e+00,  4.4161e-01, -1.3860e+00,  4.9198e+00,
         -2.4068e+00,  1.7656e-01,  8.5854e-01, -2.9058e-01,  1.8348e+00,
         -5.8134e-01,  6.4319e-01, -4.8125e-01, -1.8315e+00,  3.4023e+00,
          6.0242e-01, -2.4365e+00, -1.7915e+00, -1.0684e+00,  1.6407e+00,
          4.1523e-01, -1.9431e-01,  8.9796e-01,  1.2513e+00, -3.9205e-01,
         -4.6988e-02,  1.6839e+00,  1.7293e+00,  2.2915e+00, -3.2005e+00,
          1.5859e+00, -1.9489e+00, -4.3009e-01,  8.3103e+00,  3.4567e+00,
         -2.5523e+00,  1.3875e+00,  5.2857e-01,  1.0011e+00,  9.0176e-01,
         -1.6022e+00,  2.3209e+00,  4.1809e+00,  1.0092e+00,  1.2289e+00,
         -1.4141e+00,  5.8037e-01, -1.6329e+00, -2.2165e+00,  1.6257e+00,
          1.3510e+00,  2.9424e+00,  3.4618e+00, -5.3072e-01,  2.3717e+00,
          9.7552e-01,  7.6279e-01, -2.1588e+00,  6.4643e-01,  2.7193e+00,
          1.3360e+00,  5.5360e+00, -2.0751e+00,  8.7586e-01,  2.1392e+00,
          2.3061e-01,  3.1310e+00,  3.3724e+00, -1.4435e+00,  4.2141e+00,
          1.6856e+00, -3.4526e+00, -7.4288e-01,  2.2796e+00,  2.2660e+00,
         -1.4567e-01,  4.6093e-01,  4.7729e+00,  5.5540e-01, -1.1358e+00,
         -1.5512e+00, -6.5131e-02, -3.9337e-01, -3.7714e-01,  1.5956e+00,
         -9.0993e-01, -4.1034e+00,  2.8823e+00,  1.7014e+00, -2.8777e+00,
          4.0868e+00,  1.1970e+00,  1.2532e+00,  5.4284e-01,  4.3390e+00,
          1.2368e+00,  2.9019e+00,  7.0304e-01,  1.6639e+00,  2.7793e+00,
          1.0579e-01,  6.5928e-01,  9.2970e-01,  2.7030e+00,  2.2684e+00,
         -1.3988e+00, -8.3542e-01,  2.8726e+00, -1.2525e-01, -1.9970e-02,
         -1.4788e+00,  3.1059e+00,  7.1580e-01,  3.9129e+00,  2.9010e+00,
          3.0923e+00, -3.2601e-01,  1.5880e+00,  2.1606e+00,  4.9405e+00,
          7.4345e+00,  1.6111e+00,  4.3654e+00,  3.7047e+00, -6.9755e-01,
          1.9162e+00, -1.8260e+00,  5.5118e-01, -2.4371e+00, -4.1598e+00,
          1.3610e-01,  2.4156e+00,  7.8422e-01,  2.2263e+00,  2.5883e+00,
          3.7264e+00,  1.0824e+00,  9.4007e-01, -1.0606e+00, -2.4162e-01,
         -5.6014e-01, -2.4421e+00, -1.7808e+00,  3.2956e-01,  1.9485e+00,
         -6.4458e-01, -2.1563e+00, -6.8867e-01, -2.1929e+00, -2.2380e+00,
         -1.2292e+00, -1.4901e+00,  1.7275e-01, -2.5409e-01, -1.1474e+00,
          2.0211e-01,  6.2637e-02,  1.5705e+00, -1.1722e+00, -3.2842e-01,
          6.3981e-01, -6.5040e-01,  8.0035e-01,  8.5737e-01, -1.5545e+00,
          3.7381e+00,  2.9366e+00, -3.8424e-01,  9.5976e-01,  3.1749e+00,
         -2.9460e+00, -2.1819e+00,  6.8675e-01, -4.4182e-01, -8.1452e-01,
          1.0196e+00, -1.2688e+00, -1.3152e+00, -1.0271e+00, -1.3486e+00,
         -7.2284e-01,  5.3376e+00,  3.0590e+00,  4.2830e+00,  2.1282e+00,
         -1.1576e+00,  4.5069e+00, -3.0604e+00, -4.0468e+00, -2.1787e+00,
         -2.3163e-01, -2.3912e+00, -2.0584e+00,  7.1580e-01, -1.2593e+00,
          1.7518e+00, -3.2534e-01,  2.6729e+00, -4.7275e-01,  2.2193e+00,
          1.5873e+00, -6.6377e-01,  1.6889e+00, -1.6818e+00,  4.5131e-01,
         -5.0318e-01, -3.3471e+00, -2.9885e+00, -6.2869e+00, -2.0277e+00,
         -2.7562e+00, -3.5826e+00, -1.4681e+00,  1.8021e+00,  1.5594e+00]],
       device='cuda:0')

target = tensor([[3.2484e-07, 5.8684e-05, 1.2415e-06, 2.9337e-07, 9.4421e-07, 4.8290e-07,
         2.7960e-07, 3.6433e-06, 2.3332e-06, 2.2047e-05, 3.9200e-06, 1.1743e-05,
         3.5991e-05, 6.3618e-06, 2.4613e-06, 5.2246e-05, 7.2634e-05, 3.9089e-06,
         3.6086e-05, 4.5482e-06, 8.9830e-07, 1.8101e-05, 7.0709e-05, 8.8668e-05,
         6.0567e-06, 3.4175e-06, 5.7713e-07, 1.2360e-06, 6.3697e-07, 3.0926e-06,
         6.3431e-07, 4.4840e-06, 3.8151e-07, 1.4468e-06, 1.8255e-06, 1.0286e-06,
         3.2740e-06, 2.9556e-06, 2.9380e-07, 4.4024e-06, 2.4145e-05, 4.3909e-06,
         2.5529e-06, 1.5211e-05, 5.2328e-06, 2.3131e-06, 3.0482e-05, 6.4373e-06,
         8.9048e-07, 3.3724e-07, 8.6506e-07, 7.5265e-07, 1.2968e-06, 1.3019e-05,
         1.0863e-05, 9.0269e-06, 7.4998e-07, 8.8904e-07, 1.5424e-07, 1.9470e-04,
         4.3280e-05, 6.8282e-07, 6.2723e-07, 3.3603e-06, 4.7883e-05, 3.4218e-07,
         2.1869e-06, 5.5111e-06, 8.7050e-07, 4.4337e-06, 2.9145e-05, 5.6347e-06,
         1.8252e-05, 1.4690e-05, 1.9570e-05, 2.9079e-05, 9.0835e-06, 3.7709e-05,
         8.3290e-06, 1.6925e-05, 6.9637e-07, 3.7394e-07, 2.2014e-06, 1.8064e-06,
         2.0399e-06, 3.9977e-06, 5.0149e-07, 1.9082e-05, 1.0011e-04, 1.2317e-04,
         7.7703e-05, 1.2768e-05, 4.1213e-05, 5.8321e-04, 5.2793e-04, 9.8306e-06,
         5.4274e-04, 1.0170e-07, 1.0206e-07, 1.7336e-06, 3.1342e-06, 1.8991e-06,
         2.2756e-07, 3.0226e-06, 2.1447e-06, 8.7683e-07, 4.4846e-07, 5.1477e-05,
         9.4856e-07, 4.5407e-08, 7.6307e-07, 1.0973e-04, 1.2504e-05, 4.0108e-06,
         1.0708e-06, 7.2766e-07, 1.7710e-07, 2.7929e-05, 6.5575e-06, 2.6053e-06,
         4.2293e-06, 1.1241e-06, 1.0207e-06, 4.2247e-06, 2.1809e-06, 7.3820e-07,
         4.0455e-06, 3.4363e-06, 7.5270e-07, 6.5155e-06, 1.5570e-05, 3.4105e-07,
         1.4875e-05, 1.1678e-06, 4.8960e-06, 9.9150e-06, 3.1197e-06, 9.5741e-07,
         6.7333e-07, 9.4461e-07, 1.3683e-06, 6.8060e-07, 4.4243e-07, 1.5954e-07,
         7.3163e-06, 2.8941e-05, 1.9380e-06, 3.5957e-07, 4.7846e-07, 5.5661e-07,
         2.4988e-07, 9.2437e-06, 9.3621e-07, 3.5135e-06, 2.3478e-06, 1.2205e-05,
         1.9371e-06, 1.8698e-06, 1.4299e-06, 4.5992e-06, 6.0183e-06, 5.3168e-06,
         4.6745e-06, 9.7627e-06, 1.0445e-06, 3.8447e-06, 9.9162e-07, 4.2610e-06,
         1.1751e-06, 3.6644e-06, 1.6410e-06, 9.4559e-06, 6.6220e-06, 3.7426e-06,
         1.7912e-06, 1.8599e-06, 4.1178e-06, 4.0500e-06, 5.4481e-06, 2.7003e-07,
         1.9500e-07, 1.1019e-05, 1.3576e-06, 5.9864e-05, 2.2005e-05, 4.8714e-06,
         6.2812e-06, 1.5429e-05, 6.5495e-07, 3.5743e-06, 7.4836e-06, 7.7137e-06,
         1.4384e-06, 5.3447e-07, 8.6208e-07, 6.3075e-06, 3.2496e-05, 1.4274e-05,
         1.3135e-05, 8.6763e-06, 8.5527e-06, 6.2376e-06, 8.8710e-05, 9.9984e-06,
         1.0860e-05, 2.1969e-06, 2.1888e-06, 4.3132e-06, 4.8966e-06, 3.1722e-06,
         1.3585e-07, 4.0717e-06, 3.6232e-06, 2.7303e-06, 5.2466e-06, 6.2124e-06,
         1.0733e-06, 3.3894e-06, 1.0054e-06, 6.7276e-06, 2.6242e-06, 3.4036e-06,
         2.3766e-06, 1.0250e-05, 1.6525e-05, 1.2744e-06, 2.9823e-06, 2.1927e-07,
         9.0762e-07, 1.5217e-05, 1.3867e-06, 5.5285e-07, 3.0564e-06, 7.1280e-06,
         1.1502e-06, 1.2641e-06, 4.8767e-06, 3.5094e-06, 1.8205e-05, 2.0745e-05,
         7.5989e-06, 3.8851e-06, 1.5372e-05, 4.0137e-06, 5.2744e-07, 1.3512e-06,
         8.8763e-07, 4.1075e-06, 6.6644e-07, 7.1921e-07, 7.7339e-07, 1.7073e-05,
         3.3543e-05, 3.7139e-06, 1.6673e-05, 8.8907e-07, 8.3903e-07, 2.9730e-06,
         6.4047e-07, 5.5982e-07, 2.6775e-07, 1.1595e-07, 7.6356e-06, 1.5200e-06,
         5.1688e-07, 3.6641e-05, 1.4945e-05, 1.7328e-05, 6.0820e-07, 9.8351e-07,
         6.6901e-07, 1.2905e-05, 2.6872e-06, 7.0319e-06, 2.8024e-07, 2.8234e-06,
         3.9704e-06, 2.7556e-06, 4.6265e-07, 5.9681e-07, 4.1232e-06, 5.7375e-06,
         5.6161e-06, 5.5815e-06, 1.6410e-05, 9.6180e-06, 3.1425e-06, 8.5684e-07,
         1.1645e-06, 3.8793e-07, 4.4048e-07, 5.1914e-07, 4.8648e-07, 3.5227e-07,
         9.2589e-07, 7.0081e-07, 1.0612e-06, 1.8217e-06, 2.8430e-06, 1.6363e-05,
         5.1035e-07, 3.1577e-05, 2.7109e-06, 2.0635e-05, 2.8451e-06, 2.1352e-06,
         7.8671e-06, 7.6468e-06, 1.4684e-03, 1.1230e-04, 8.1144e-05, 9.2713e-06,
         3.6593e-05, 1.9200e-04, 1.4553e-04, 6.5931e-03, 1.6016e-04, 2.4266e-05,
         1.3844e-04, 2.5096e-04, 2.8109e-05, 3.6522e-06, 6.6171e-07, 1.2470e-04,
         2.9994e-05, 8.7174e-06, 2.4396e-06, 2.4077e-06, 2.3997e-06, 8.3495e-09,
         1.9625e-06, 1.1932e-06, 5.4834e-07, 3.3230e-06, 2.6303e-07, 1.1235e-06,
         3.0508e-07, 2.8249e-07, 8.3615e-07, 8.6912e-07, 5.0412e-06, 1.2180e-07,
         3.4570e-07, 9.1822e-07, 7.8276e-09, 1.1348e-06, 1.0390e-07, 1.2804e-06,
         4.1263e-07, 3.7808e-07, 8.0726e-07, 3.0270e-07, 1.9584e-06, 6.7698e-07,
         1.2327e-05, 7.8592e-06, 2.1086e-05, 2.5028e-07, 1.1480e-06, 1.2322e-05,
         7.2861e-07, 1.5549e-06, 7.8669e-07, 5.2973e-07, 6.8015e-07, 7.7159e-07,
         1.2309e-06, 1.3800e-06, 4.5828e-06, 2.9820e-06, 3.8424e-06, 1.1095e-05,
         5.8685e-06, 6.0035e-07, 1.0676e-05, 2.9328e-06, 2.6233e-07, 1.3055e-05,
         4.4819e-06, 2.5387e-06, 1.4445e-05, 1.1694e-05, 1.4862e-05, 2.0971e-06,
         8.8153e-07, 1.8724e-06, 3.2154e-06, 2.1193e-06, 4.2542e-07, 1.8484e-06,
         2.5965e-06, 2.5480e-07, 1.2631e-06, 2.6695e-06, 3.1325e-07, 9.2038e-07,
         2.3231e-06, 7.7158e-07, 4.2917e-05, 8.5713e-05, 6.9200e-05, 7.6636e-05,
         3.4038e-03, 7.5538e-07, 4.3999e-06, 2.2642e-05, 1.0743e-05, 2.5788e-05,
         2.4236e-07, 3.3483e-03, 7.2476e-07, 5.7703e-07, 5.6899e-05, 5.2448e-06,
         1.8670e-05, 1.9184e-06, 2.7738e-05, 4.2052e-04, 1.0936e-03, 1.8908e-04,
         6.6592e-05, 6.0675e-03, 8.7149e-07, 3.0584e-06, 1.9964e-05, 2.9430e-06,
         2.0717e-04, 9.0802e-05, 9.6495e-06, 5.0754e-06, 5.1236e-05, 3.8806e-07,
         1.2677e-05, 1.1842e-05, 5.6005e-06, 2.0317e-05, 2.2863e-06, 1.0897e-04,
         8.5413e-05, 6.7549e-05, 1.3177e-04, 4.4558e-03, 2.1250e-05, 2.0319e-06,
         5.8586e-06, 1.1306e-05, 7.0378e-04, 7.4860e-04, 2.4174e-05, 1.5020e-06,
         2.5072e-07, 2.2920e-04, 1.4431e-06, 3.5627e-05, 2.4012e-05, 3.6719e-05,
         5.7846e-05, 1.0733e-04, 3.7332e-06, 5.7524e-05, 8.3994e-07, 1.1291e-05,
         5.5847e-06, 3.4048e-04, 5.7808e-05, 1.1445e-06, 6.6345e-05, 7.9159e-07,
         2.1774e-04, 7.4219e-05, 6.4086e-03, 3.0139e-06, 1.7094e-05, 2.6908e-05,
         3.4936e-06, 7.2892e-02, 1.9202e-05, 3.0302e-06, 2.5429e-05, 2.2503e-04,
         2.6752e-05, 1.3851e-04, 1.2097e-04, 1.6333e-06, 2.1647e-07, 3.2325e-04,
         7.1395e-05, 1.4907e-05, 5.2645e-05, 3.9741e-04, 3.8248e-06, 2.0401e-06,
         5.4131e-06, 2.7456e-06, 6.8572e-04, 1.2461e-05, 2.1753e-06, 8.8675e-05,
         7.2387e-04, 1.8204e-05, 5.8048e-07, 1.1069e-04, 1.4149e-06, 8.4536e-05,
         3.3996e-03, 8.0399e-04, 2.5331e-03, 5.9678e-05, 5.3112e-04, 1.2490e-06,
         3.5873e-07, 5.9381e-06, 3.6188e-04, 8.9578e-04, 1.0331e-05, 1.1700e-04,
         2.6608e-06, 5.4609e-05, 2.3019e-04, 5.0241e-06, 5.0484e-07, 5.5310e-05,
         7.2985e-06, 1.2506e-05, 1.3064e-06, 2.1945e-06, 1.9899e-05, 1.0792e-04,
         1.2128e-04, 6.0101e-07, 2.7508e-03, 1.1643e-04, 1.3011e-05, 9.0462e-06,
         1.8344e-05, 2.5894e-05, 1.2198e-06, 8.0273e-07, 9.6513e-05, 5.7674e-06,
         2.9324e-06, 1.9015e-04, 9.2013e-04, 7.6756e-06, 5.8828e-06, 3.9426e-03,
         6.0797e-05, 1.9894e-06, 2.6783e-06, 3.5533e-05, 1.4034e-04, 7.6887e-05,
         6.0618e-05, 7.2002e-06, 3.1027e-07, 2.9549e-06, 1.6991e-03, 5.3649e-05,
         8.9632e-06, 1.6558e-05, 4.9340e-06, 3.6194e-06, 2.3771e-04, 2.0147e-03,
         7.2173e-06, 6.6672e-06, 1.1635e-03, 5.8843e-05, 3.1011e-05, 6.1152e-07,
         1.1600e-04, 5.5043e-04, 9.5611e-04, 6.5599e-07, 1.2030e-05, 6.0375e-06,
         5.6262e-06, 1.6061e-04, 4.8735e-05, 2.4792e-04, 3.9850e-05, 1.8380e-04,
         1.8123e-06, 5.2710e-05, 5.0558e-05, 8.7777e-05, 1.6553e-07, 1.2541e-04,
         6.0393e-06, 1.5353e-04, 1.2631e-06, 2.0480e-06, 1.6745e-04, 2.7557e-04,
         2.2130e-04, 7.0714e-07, 1.1720e-04, 2.6479e-06, 4.5665e-05, 3.0419e-05,
         1.1135e-03, 8.2483e-06, 8.5763e-06, 2.0894e-07, 1.1942e-02, 3.6559e-05,
         7.8691e-05, 9.8801e-04, 2.9754e-05, 7.6702e-06, 3.0261e-05, 6.6307e-06,
         1.7402e-06, 6.4587e-04, 5.2220e-05, 1.1218e-05, 1.9754e-04, 1.9151e-05,
         3.4147e-04, 5.3281e-01, 8.8447e-05, 1.4667e-06, 5.2856e-04, 5.6145e-04,
         1.6337e-05, 3.3819e-07, 1.3436e-03, 2.6967e-06, 1.4228e-06, 1.2049e-04,
         1.0218e-05, 3.0067e-05, 2.6306e-04, 7.2715e-03, 9.7508e-07, 6.5657e-05,
         1.0459e-05, 3.9539e-06, 3.7230e-05, 4.6209e-06, 5.7757e-07, 4.1501e-05,
         8.0115e-05, 2.9999e-04, 1.5715e-02, 3.0386e-06, 2.7803e-05, 3.5040e-05,
         1.4641e-05, 1.6100e-06, 4.8325e-03, 3.8359e-05, 4.9473e-06, 2.6618e-06,
         6.9095e-06, 1.7539e-05, 4.4592e-06, 6.5542e-06, 7.7779e-06, 2.8665e-05,
         2.7287e-06, 6.4406e-06, 3.1786e-05, 1.4884e-05, 2.8731e-04, 2.3698e-05,
         2.7763e-05, 2.3362e-05, 2.7712e-06, 5.2157e-06, 1.2261e-05, 2.1052e-05,
         1.6081e-04, 1.3411e-03, 1.7764e-04, 3.9328e-07, 3.1801e-06, 1.4630e-04,
         1.0857e-05, 3.7530e-05, 2.8692e-05, 9.8953e-05, 6.2891e-05, 1.9646e-05,
         1.4811e-05, 5.9996e-05, 1.2092e-05, 7.7206e-06, 1.1704e-04, 2.0981e-06,
         3.6940e-08, 4.5651e-05, 1.3362e-05, 3.6073e-05, 1.6269e-06, 5.9314e-05,
         4.7115e-04, 4.2165e-06, 1.2724e-05, 7.4954e-05, 4.3297e-05, 1.6262e-05,
         1.0894e-05, 8.5171e-05, 4.5342e-04, 1.4797e-05, 5.8418e-06, 5.6305e-05,
         3.3880e-05, 4.8446e-06, 1.5890e-04, 5.6698e-03, 2.6204e-05, 3.2674e-05,
         3.9306e-03, 8.9267e-07, 9.2233e-05, 2.4946e-06, 8.3169e-05, 2.5835e-05,
         8.0145e-05, 1.4950e-06, 2.6695e-04, 4.5228e-04, 1.6647e-06, 4.0172e-04,
         2.5840e-07, 6.7111e-05, 1.6220e-05, 1.0927e-05, 5.0832e-06, 1.3176e-04,
         1.2526e-04, 1.5240e-04, 7.9146e-06, 6.3339e-06, 2.7795e-05, 1.3726e-04,
         7.8708e-06, 8.1561e-06, 4.3152e-05, 4.9689e-07, 1.7082e-05, 2.1865e-04,
         2.4128e-05, 1.1905e-03, 1.8955e-05, 2.4046e-04, 2.2400e-06, 7.4721e-04,
         1.3362e-05, 5.8918e-06, 7.6785e-05, 1.8859e-05, 7.2723e-05, 9.3028e-05,
         5.4119e-06, 2.4647e-06, 4.2822e-06, 2.2762e-04, 9.1630e-05, 1.0615e-04,
         1.9160e-04, 3.9906e-05, 9.1591e-05, 8.0473e-05, 1.9094e-07, 8.6278e-04,
         6.3309e-06, 6.8880e-05, 9.9235e-06, 2.1004e-05, 1.7419e-04, 1.0721e-04,
         4.3012e-05, 1.9671e-06, 1.1842e-03, 2.1717e-05, 7.3338e-05, 1.3434e-03,
         1.2180e-05, 1.6901e-05, 1.4789e-04, 4.9479e-05, 2.1147e-04, 7.5976e-04,
         8.3316e-05, 3.0688e-05, 3.5998e-06, 1.5643e-03, 4.1536e-07, 2.0632e-06,
         4.4098e-05, 5.4063e-06, 1.6447e-05, 4.5612e-06, 1.6500e-05, 1.9959e-06,
         1.1970e-06, 1.6069e-04, 1.9114e-05, 1.7558e-06, 3.3098e-06, 1.3095e-06,
         7.4111e-05, 6.0355e-05, 6.0561e-06, 2.1858e-04, 6.0644e-05, 3.7351e-05,
         7.7897e-06, 2.2377e-04, 2.0890e-04, 2.8067e-04, 7.2789e-07, 6.7542e-05,
         5.3642e-06, 1.5897e-05, 1.6536e-01, 1.5192e-04, 3.0214e-07, 3.3441e-05,
         3.9106e-05, 2.4060e-04, 3.5975e-05, 4.7290e-07, 6.9219e-04, 3.2550e-03,
         7.1204e-05, 4.2738e-05, 2.0150e-06, 1.2658e-05, 1.0345e-06, 5.6612e-07,
         3.8695e-05, 1.8179e-04, 3.3649e-03, 4.1304e-03, 2.5814e-05, 3.0061e-05,
         1.0993e-05, 2.2064e-05, 1.7705e-06, 1.7855e-05, 1.9560e-04, 2.1014e-05,
         2.7239e-02, 8.1815e-07, 1.8663e-04, 2.2717e-04, 1.8376e-05, 5.0550e-04,
         4.6127e-04, 1.1572e-06, 4.2915e-04, 8.2257e-05, 3.2232e-07, 1.8865e-06,
         6.2467e-05, 2.3181e-04, 6.1590e-06, 4.2064e-05, 2.8752e-03, 1.1219e-05,
         3.6252e-06, 2.7181e-06, 1.0488e-05, 2.8689e-06, 6.6279e-06, 4.3564e-05,
         9.4551e-06, 8.8221e-08, 8.7552e-05, 3.5213e-05, 5.4504e-07, 1.3025e-03,
         1.8966e-05, 1.5475e-05, 1.3276e-05, 2.1668e-04, 6.3166e-05, 1.2521e-04,
         5.1231e-05, 1.6060e-04, 3.3792e-05, 4.8200e-06, 2.3065e-05, 1.1037e-05,
         7.0609e-05, 7.4185e-05, 1.2190e-05, 1.0219e-05, 1.2677e-03, 8.8026e-06,
         5.6007e-06, 3.2072e-06, 1.7248e-04, 5.6017e-05, 3.3304e-04, 2.9841e-04,
         1.9826e-04, 1.6756e-05, 1.6160e-04, 1.4472e-04, 5.6427e-04, 3.4865e-03,
         2.8706e-05, 1.0709e-03, 8.4248e-04, 1.3663e-05, 5.5295e-04, 8.4719e-07,
         1.0417e-05, 4.1686e-07, 1.7816e-07, 1.1450e-05, 1.3188e-04, 5.0296e-05,
         2.7861e-04, 2.1400e-04, 1.3416e-03, 3.8942e-05, 3.6133e-05, 1.8967e-05,
         3.0056e-05, 3.3276e-05, 3.3316e-06, 4.8045e-06, 6.8821e-05, 2.3143e-04,
         1.0098e-05, 9.4139e-07, 7.0210e-06, 1.2093e-06, 1.8778e-06, 6.0095e-06,
         9.1490e-07, 3.6773e-05, 1.1875e-05, 3.1062e-06, 1.0339e-04, 3.2096e-05,
         4.9665e-04, 2.6129e-06, 6.8905e-06, 3.4081e-05, 2.7838e-06, 6.1724e-05,
         2.6786e-05, 3.0886e-06, 2.6662e-03, 5.2617e-04, 1.2336e-05, 2.1218e-05,
         1.5793e-03, 4.7584e-07, 7.1516e-07, 3.1967e-05, 2.7002e-06, 1.1590e-05,
         1.7802e-04, 3.9571e-06, 3.4334e-06, 1.1129e-05, 5.0185e-06, 8.4250e-06,
         6.7394e-03, 1.0231e-03, 2.3009e-03, 5.6493e-04, 2.9756e-06, 3.6399e-03,
         2.5283e-07, 1.3724e-07, 5.9175e-07, 7.0321e-06, 7.7850e-07, 1.6757e-06,
         2.1895e-05, 1.1594e-06, 4.3457e-05, 7.9218e-06, 6.3043e-05, 7.1364e-06,
         8.4778e-05, 9.8126e-05, 1.3284e-05, 9.3083e-05, 1.2454e-06, 5.3992e-05,
         2.4491e-06, 2.4914e-06, 6.5149e-07, 1.2651e-08, 3.6865e-06, 9.0228e-07,
         5.4478e-07, 8.6635e-06, 7.9694e-05, 3.4268e-05]], device='cuda:0')

def softmax(x):
    return np.exp(x) / np.sum(np.exp(x), axis=0)

#out = sf(out, dim=-1).cpu().numpy()
#target = sf(target, dim=-1).cpu().numpy()
out = out.cpu().numpy()
target = target.cpu().numpy()

cross_entropy_loss = -np.sum( np.emath.log(np.exp(out) / np.sum(np.exp(out))) * target )
print(cross_entropy_loss)